NAME
  threadify

DESCRIPTION

INSTALL
  gem install threadify

SAMPLES
  
  <========< sample/a.rb >========>

  ~ > cat sample/a.rb

    require 'open-uri'
    require 'yaml'
    
    require 'rubygems'
    require 'threadify'
    
    
    uris =
      %w(
        http://google.com
        http://yahoo.com
        http://rubyforge.org
        http://ruby-lang.org
        http://kcrw.org
        http://drawohara.com
        http://codeforpeople.com
      )
    
    
    time 'without threadify' do
      uris.each do |uri|
        body = open(uri){|pipe| pipe.read}
      end
    end
    
    
    time 'with threadify' do
      uris.threadify do |uri|
        body = open(uri){|pipe| pipe.read}
      end
    end
    
    
    BEGIN {
      def time label
        a = Time.now.to_f
        yield
      ensure
        b = Time.now.to_f
        y label => (b - a)
      end
    }

  ~ > ruby sample/a.rb

    --- 
    without threadify: 7.70478916168213
    --- 
    with threadify: 1.69362306594849


  <========< sample/b.rb >========>

  ~ > cat sample/b.rb

    require 'yaml'
    
    require 'rubygems'
    require 'threadify'
    
    size = Integer(ARGV.shift || (2 ** 15))
    
    haystack = Array.new(size){|i| i}
    needle = 2 * (size / 3) 
    
    a, b = 4, 2
    
    time 'without threadify' do
      a = haystack.each{|value| break value if value == needle}
    end
    
    time 'with threadify' do
      b = haystack.threadify(16){|value| threadify! value if value == needle}
    end
    
    raise if a != b
    
    y :a => a, :b => b, :needle => needle
    
    BEGIN {
      def time label
        a = Time.now.to_f
        yield
      ensure
        b = Time.now.to_f
        y label => (b - a)
      end
    }

  ~ > ruby sample/b.rb

    --- 
    without threadify: 0.00685286521911621
    --- 
    with threadify: 0.546236038208008
    --- 
    :needle: 21844
    :a: 21844
    :b: 21844


